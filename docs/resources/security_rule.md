---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "illumio-core_security_rule Resource - terraform-provider-illumio-core"
subcategory: ""
description: |-
  Manages Illumio Security Rule
---

# illumio-core_security_rule (Resource)

Manages Illumio Security Rule

## Example Usage

```terraform
resource "illumio-core_label" "app_core_services" {
  key   = "app"
  value = "A-CORE-SERVICES"
}

resource "illumio-core_label" "env_prod" {
  key   = "env"
  value = "E-PROD"
}

resource "illumio-core_rule_set" "core_services_prod" {
  name = "RS-CORE-SERVICES-PROD"

  scopes {
    label {
      href = illumio-core_label.app_core_services.href
    }

    label {
      href = illumio-core_label.env_prod.href
    }
  }
}

# use the services data source to search against the /services endpoint by name
data "illumio-core_services" "all_services" {
  # all PCE instances define a default Service covering all service ports
  name = "All Services"
  max_results = 1
}

resource "illumio-core_security_rule" "example" {
  rule_set_href = illumio-core_rule_set.core_services_prod.href

  enabled = true

  resolve_labels_as {
    consumers = ["workloads"]
    providers = ["workloads"]
  }

  consumers {
    actors = "ams"  # special notation meaning "all managed systems" - affects all workloads
  }

  providers {
    actors = "ams"
  }

  ingress_services {
    href = one(data.illumio-core_services.all_services.items[*].href)
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `consumers` (Block Set, Min: 1) Consumers for Security Rule. Only one actor can be specified in one consumer block (see [below for nested schema](#nestedblock--consumers))
- `enabled` (Boolean) Enabled flag. Determines whether the rule will be enabled in ruleset or not
- `providers` (Block Set, Min: 1) providers for Security Rule. Only one actor can be specified in one providers block (see [below for nested schema](#nestedblock--providers))
- `resolve_labels_as` (Block List, Min: 1, Max: 1) resolve label as for Security rule (see [below for nested schema](#nestedblock--resolve_labels_as))
- `rule_set_href` (String) URI of Rule set, in which security rule will be added

### Optional

- `description` (String) Description of Security Rule
- `external_data_reference` (String) External data reference identifier
- `external_data_set` (String) External data set identifier
- `ingress_services` (Block Set) Collection of Ingress Service. If resolve_label_as.providers list includes "workloads" then ingress_service is required. Only one of the {"href"} or {"proto", "port", "to_port"} parameter combination is allowed (see [below for nested schema](#nestedblock--ingress_services))
- `machine_auth` (Boolean) Determines whether machine authentication is enabled. Default value: false
- `sec_connect` (Boolean) Determines whether a secure connection is established. Default value: false
- `stateless` (Boolean) Determines whether packet filtering is stateless for the rule. Default value: false
- `unscoped_consumers` (Boolean) If false (the default), the created Rule will be an intra-scope rule. If true, it will be extra-scope. Default value: false

### Read-Only

- `created_at` (String) Timestamp when this security rule was first created
- `created_by` (Map of String) User who created this security rule
- `deleted_at` (String) Timestamp when this security rule was deleted
- `deleted_by` (Map of String) User who deleted this security rule
- `href` (String) URI of Security Rule
- `id` (String) The ID of this resource
- `update_type` (String) Type of update
- `updated_at` (String) Timestamp when this security rule was last updated
- `updated_by` (Map of String) User who last updated this security rule

<a id="nestedblock--consumers"></a>
### Nested Schema for `consumers`

Optional:

- `actors` (String) Consumer workloads filter. Allowed values are "ams" and "container_host"
- `exclusion` (Boolean) Boolean to specify whether or not the actor is an exclusion - only for labels and label groups. Requires PCE v22.5+
- `ip_list` (Block Set, Max: 1) IP List consumer filter (see [below for nested schema](#nestedblock--consumers--ip_list))
- `label` (Block Set, Max: 1) Label consumer filter (see [below for nested schema](#nestedblock--consumers--label))
- `label_group` (Block Set, Max: 1) Label Group consumer filter (see [below for nested schema](#nestedblock--consumers--label_group))
- `virtual_service` (Block Set, Max: 1) Virtual Service consumer filter (see [below for nested schema](#nestedblock--consumers--virtual_service))
- `workload` (Block Set, Max: 1) Workload consumer filter (see [below for nested schema](#nestedblock--consumers--workload))

<a id="nestedblock--consumers--ip_list"></a>
### Nested Schema for `consumers.ip_list`

Required:

- `href` (String) URI of this IP List

Read-Only:

- `created_at` (String) Timestamp when this IP List was first created
- `created_by` (Map of String) User who created this IP List
- `deleted_at` (String) Timestamp when this IP List was deleted
- `deleted_by` (Map of String) User who deleted this IP List
- `description` (String) Description of the IP List
- `external_data_reference` (String) A unique identifier within the external data source
- `external_data_set` (String) The data source from which a resource originates
- `fqdns` (List of Object) Collection of Fully Qualified Domain Names (see [below for nested schema](#nestedatt--consumers--ip_list--fqdns))
- `ip_ranges` (List of Object) IP addresses or ranges (see [below for nested schema](#nestedatt--consumers--ip_list--ip_ranges))
- `name` (String) Name of the IP List
- `updated_at` (String) Timestamp when this IP List was last updated
- `updated_by` (Map of String) User who last updated this IP List

<a id="nestedatt--consumers--ip_list--fqdns"></a>
### Nested Schema for `consumers.ip_list.fqdns`

Read-Only:

- `description` (String) Description of FQDN
- `fqdn` (String) Fully Qualified Domain Name


<a id="nestedatt--consumers--ip_list--ip_ranges"></a>
### Nested Schema for `consumers.ip_list.ip_ranges`

Read-Only:

- `description` (String) Description of the IP Range
- `exclusion` (Boolean) Whether this IP address is an exclusion. Exclusions must be a strict subset of inclusive IP addresses
- `from_ip` (String) IP address or a low end of IP range. Might be specified with CIDR notation
- `to_ip` (String) High end of an IP range



<a id="nestedblock--consumers--label"></a>
### Nested Schema for `consumers.label`

Required:

- `href` (String) Label URI

Read-Only:

- `key` (String) Label key
- `value` (String) Label value


<a id="nestedblock--consumers--label_group"></a>
### Nested Schema for `consumers.label_group`

Required:

- `href` (String) URI of Label Group


<a id="nestedblock--consumers--virtual_service"></a>
### Nested Schema for `consumers.virtual_service`

Required:

- `href` (String) URI of Virtual Service


<a id="nestedblock--consumers--workload"></a>
### Nested Schema for `consumers.workload`

Required:

- `href` (String) Workload URI

Read-Only:

- `deleted` (Boolean) Whether the workload has been deleted in the PCE
- `hostname` (String) Workload hostname
- `name` (String) Workload name



<a id="nestedblock--providers"></a>
### Nested Schema for `providers`

Optional:

- `actors` (String) All workloads provider filter. If specified, must have value "ams"
- `exclusion` (Boolean) Boolean to specify whether or not the actor is an exclusion - only for labels and label groups. Requires PCE v22.5+
- `ip_list` (Block Set, Max: 1) IP List provider filter (see [below for nested schema](#nestedblock--providers--ip_list))
- `label` (Block Set, Max: 1) Label provider filter (see [below for nested schema](#nestedblock--providers--label))
- `label_group` (Block Set, Max: 1) Label Group provider filter (see [below for nested schema](#nestedblock--providers--label_group))
- `virtual_server` (Block Set, Max: 1) Virtual Server provider filter (see [below for nested schema](#nestedblock--providers--virtual_server))
- `virtual_service` (Block Set, Max: 1) Virtual Service provider filter (see [below for nested schema](#nestedblock--providers--virtual_service))
- `workload` (Block Set, Max: 1) Workload provider filter (see [below for nested schema](#nestedblock--providers--workload))

<a id="nestedblock--providers--ip_list"></a>
### Nested Schema for `providers.ip_list`

Required:

- `href` (String) URI of this IP List

Read-Only:

- `created_at` (String) Timestamp when this IP List was first created
- `created_by` (Map of String) User who created this IP List
- `deleted_at` (String) Timestamp when this IP List was deleted
- `deleted_by` (Map of String) User who deleted this IP List
- `description` (String) Description of the IP List
- `external_data_reference` (String) A unique identifier within the external data source
- `external_data_set` (String) The data source from which a resource originates
- `fqdns` (List of Object) Collection of Fully Qualified Domain Names (see [below for nested schema](#nestedatt--providers--ip_list--fqdns))
- `ip_ranges` (List of Object) IP addresses or ranges (see [below for nested schema](#nestedatt--providers--ip_list--ip_ranges))
- `name` (String) Name of the IP List
- `updated_at` (String) Timestamp when this IP List was last updated
- `updated_by` (Map of String) User who last updated this IP List

<a id="nestedatt--providers--ip_list--fqdns"></a>
### Nested Schema for `providers.ip_list.fqdns`

Read-Only:

- `description` (String) Description of FQDN
- `fqdn` (String) Fully Qualified Domain Name


<a id="nestedatt--providers--ip_list--ip_ranges"></a>
### Nested Schema for `providers.ip_list.ip_ranges`

Read-Only:

- `description` (String) Description of the IP Range
- `exclusion` (Boolean) Whether this IP address is an exclusion. Exclusions must be a strict subset of inclusive IP addresses
- `from_ip` (String) IP address or a low end of IP range. Might be specified with CIDR notation
- `to_ip` (String) High end of an IP range



<a id="nestedblock--providers--label"></a>
### Nested Schema for `providers.label`

Required:

- `href` (String) Label URI

Read-Only:

- `key` (String) Label key
- `value` (String) Label value


<a id="nestedblock--providers--label_group"></a>
### Nested Schema for `providers.label_group`

Required:

- `href` (String) URI of Label Group


<a id="nestedblock--providers--virtual_server"></a>
### Nested Schema for `providers.virtual_server`

Required:

- `href` (String) URI of Virtual Server


<a id="nestedblock--providers--virtual_service"></a>
### Nested Schema for `providers.virtual_service`

Required:

- `href` (String) Virtual Service URI

Read-Only:

- `name` (String) Virtual Service name


<a id="nestedblock--providers--workload"></a>
### Nested Schema for `providers.workload`

Required:

- `href` (String) Workload URI

Read-Only:

- `deleted` (Boolean) Whether the workload has been deleted in the PCE
- `hostname` (String) Workload hostname
- `name` (String) Workload name



<a id="nestedblock--resolve_labels_as"></a>
### Nested Schema for `resolve_labels_as`

Required:

- `consumers` (Set of String) consumers for resolve_labels_as. Allowed values are "workloads", "virtual_services"
- `providers` (Set of String) providers for resolve_labels_as. Allowed values are "workloads", "virtual_services"


<a id="nestedblock--ingress_services"></a>
### Nested Schema for `ingress_services`

Optional:

- `href` (String) URI of Service
- `port` (String) Port number used with protocol or starting port when specifying a range. Allowed range is 0-65535
- `proto` (String) Protocol number. Allowed values are 6 (TCP) and 17 (UDP)
- `to_port` (String) Upper end of port range. Allowed range is 0-65535

## Import

Import is supported using the following syntax:

```shell
# Security Rule objects can be imported from the Illumio PCE.
# The imported ID must match the HREF of the remote object.

terraform import illumio-core_security_rule.example "/orgs/1/sec_policy/draft/rule_sets/1/sec_rules/1"
```
