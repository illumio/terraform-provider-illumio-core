// Copyright 2021 Illumio, Inc. All Rights Reserved.

package models

type VulnerabilityReport struct {
	Name                    string                            `json:"name"`
	ReportType              string                            `json:"report_type"`
	Authoritative           *bool                             `json:"authoritative,omitempty"`
	ScannedIps              []string                          `json:"scanned_ips,omitempty"`
	DetectedVulnerabilities []*VulReportDetectedVulnerability `json:"detected_vulnerabilities,omitempty"`
	ExportedAt              string                            `json:"exported_at,omitempty"`
}

type VulReportDetectedVulnerability struct {
	IPAddress             string `json:"ip_address"`
	Port                  string `json:"port,omitempty"`
	Proto                 string `json:"proto,omitempty"`
	Workload              *Href  `json:"workload"`
	Vulnerability         *Href  `json:"vulnerability"`
	ExternalDataReference string `json:"external_data_reference,omitempty"`
	State                 string `json:"state,omitempty"`
}

func (vr *VulnerabilityReport) ToMap() (map[string]interface{}, error) {
	return toMap(vr)
}

func (vrdv *VulReportDetectedVulnerability) ToMap() (map[string]interface{}, error) {
	return toMap(vrdv)
}
