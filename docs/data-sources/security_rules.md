---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "illumio-core_security_rules Data Source - terraform-provider-illumio-core"
subcategory: ""
description: |-
  Represents Illumio Security Rules
---

# illumio-core_security_rules (Data Source)

Represents Illumio Security Rules

## Example Usage

```terraform
resource "illumio-core_label" "app_web" {
  key   = "app"
  value = "A-WEB"
}

resource "illumio-core_label" "role_database" {
  key   = "role"
  value = "R-DB"
}

resource "illumio-core_label" "role_web_server" {
  key   = "role"
  value = "R-WEB-SERVER"
}

resource "illumio-core_rule_set" "web_apps" {
  name = "RS-WEB"

  scopes {
    label {
      href = illumio-core_label.app_web.href
    }
  }
}

resource "illumio-core_service" "mysql" {
  name        = "S-MYSQL"
  description = "MySQL default service port"

  service_ports {
    # Illumio uses the IANA protocol numbers to identify the service proto
    proto = "6"  # TCP
    port  = "3306"
  }
}

resource "illumio-core_service" "http" {
  name        = "S-HTTP"
  description = "HTTP(S) default ports"

  service_ports {
    proto = "6"
    port  = "80"
  }

  service_ports {
    proto = "6"
    port  = "443"
  }
}

resource "illumio-core_security_rule" "web_mysql" {
  rule_set_href = illumio-core_rule_set.web_apps.href

  enabled = true

  resolve_labels_as {
    consumers = ["workloads"]
    providers = ["workloads"]
  }

  consumers {
    label {
      href = illumio-core_label.role_web_server.href
    }
  }

  providers {
    label {
      href = illumio-core_label.role_database.href
    }
  }

  ingress_services {
    href = illumio-core_service.mysql.href
  }
}

# use the ip_lists data source to search against the /ip_lists endpoint by name
data "illumio-core_ip_lists" "default" {
  # all PCE instances define a special default IP list covering all addresses
  name = "Any (0.0.0.0/0 and ::/0)"
  max_results = 1
}

resource "illumio-core_security_rule" "web_http_inbound" {
  rule_set_href = illumio-core_rule_set.web_apps.href

  enabled = true

  resolve_labels_as {
    consumers = ["workloads"]
    providers = ["workloads"]
  }

  consumers {
    ip_list {
      href = one(data.illumio-core_ip_lists.default.items[*].href)
    }
  }

  providers {
    label {
      href = illumio-core_label.role_web_server.href
    }
  }

  ingress_services {
    href = illumio-core_service.http.href
  }
}

data "illumio-core_security_rules" "web_application_rules" {
  rule_set_href = illumio-core_rule_set.web_apps.href

  # despite the explicit dependency on the ruleset itself,
  # the implicit dependencies on the rules it contains need
  # to be explicitly defined here to ensure they're created
  # before the data source is populated
  depends_on = [
    illumio-core_security_rule.web_mysql,
    illumio-core_security_rule.web_http_inbound,
  ]
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `rule_set_href` (String) URI of ruleset

### Optional

- `external_data_reference` (String) A unique identifier within the external data source
- `external_data_set` (String) The data source from which a resource originates

### Read-Only

- `id` (String) The ID of this resource
- `items` (List of Object) list of Security Rule hrefs (see [below for nested schema](#nestedatt--items))

<a id="nestedatt--items"></a>
### Nested Schema for `items`

Read-Only:

- `consumers` (Set of Object) consumers of Security Rule (see [below for nested schema](#nestedobjatt--items--consumers))
- `created_at` (String) Timestamp when this security rule was first created
- `created_by` (Map of String) User who created this security rule
- `deleted_at` (String) Timestamp when this security rule was deleted
- `deleted_by` (Map of String) User who deleted this security rule
- `description` (String) Description of Security Rule
- `enabled` (Boolean) Enabled flag. Determines whether this rule will be enabled in ruleset or not
- `external_data_reference` (String) External data reference identifier
- `external_data_set` (String) External data set identifier
- `href` (String) URI of Security Rule
- `ingress_services` (List of Object) Collection of Ingress Services (see [below for nested schema](#nestedobjatt--items--ingress_services))
- `machine_auth` Determines whether machine authentication is enabled (Boolean)
- `providers` (Set of Object) providers of Security Rule (see [below for nested schema](#nestedobjatt--items--providers))
- `resolve_labels_as` (List of Object) resolve_label_as of Security rule (see [below for nested schema](#nestedobjatt--items--resolve_labels_as))
- `sec_connect` (Boolean) Determines whether a secure connection is established
- `stateless` (Boolean) Determines whether packet filtering is stateless for the rule
- `unscoped_consumers` (Boolean) Set the scope for rule consumers to All
- `update_type` (String) Type of update
- `updated_at` (String) Timestamp when this security rule was last updated
- `updated_by` (Map of String) User who last updated this security rule

<a id="nestedobjatt--items--consumers"></a>
### Nested Schema for `items.consumers`

Read-Only:

- `actors` (String) All workloads consumer filter
- `exclusion` (Boolean) Boolean to specify whether or not the actor is an exclusion - only for labels and label groups. Requires PCE v22.5+
- `ip_list` (Set of Object) IP List consumer filter (see [below for nested schema](#nestedobjatt--items--consumers--ip_list))
- `label` (Set of Object) Label consumer filter (see [below for nested schema](#nestedobjatt--items--consumers--label))
- `label_group` (Set of Object) Label Group consumer filter (see [below for nested schema](#nestedobjatt--items--consumers--label_group))
- `virtual_service` (Set of Object) Virtual Service consumer filter (see [below for nested schema](#nestedobjatt--items--consumers--virtual_service))
- `workload` (Set of Object) Workload consumer filter (see [below for nested schema](#nestedobjatt--items--consumers--workload))

<a id="nestedobjatt--items--consumers--ip_list"></a>
### Nested Schema for `items.consumers.ip_list`

Read-Only:

- `created_at` (String) Timestamp when this IP List was first created
- `created_by` (Map of String) User who created this IP List
- `deleted_at` (String) Timestamp when this IP List was last deleted
- `deleted_by` (Map of String) User who last deleted this IP List
- `description` (String) IP List description
- `external_data_reference` (String) A unique identifier within the external data source
- `external_data_set` (String) The data source from which a resource originates
- `fqdns` (List of Object) Collection of Fully Qualified Domain Names (see [below for nested schema](#nestedobjatt--items--consumers--ip_list--fqdns))
- `href` (String) IP List URI
- `ip_ranges` (List of Object) IP addresses or ranges (see [below for nested schema](#nestedobjatt--items--consumers--ip_list--ip_ranges))
- `name` (String) IP List name
- `updated_at` (String) Timestamp when this IP List was last updated
- `updated_by` (Map of String) User who last updated this IP List

<a id="nestedobjatt--items--consumers--ip_list--fqdns"></a>
### Nested Schema for `items.consumers.ip_list.updated_by`

Read-Only:

- `description` (String) FQDN description
- `fqdn` (String) Fully Qualified Domain Name


<a id="nestedobjatt--items--consumers--ip_list--ip_ranges"></a>
### Nested Schema for `items.consumers.ip_list.updated_by`

Read-Only:

- `description` (String) IP range description
- `exclusion` (Boolean) Boolean to specify whether or not the actor is an exclusion - only for labels and label groups. Requires PCE v22.5+
- `from_ip` (String) IP address or a low end of IP range. Might be specified with CIDR notation. The IP given should be in CIDR format example "0.0.0.0/0"
- `to_ip` (String) High end of an IP range



<a id="nestedobjatt--items--consumers--label"></a>
### Nested Schema for `items.consumers.label`

Read-Only:

- `href` (String) Label URI
- `key` (String) Label key
- `value` (String) Label value


<a id="nestedobjatt--items--consumers--label_group"></a>
### Nested Schema for `items.consumers.label_group`

Read-Only:

- `href` (String) Label Group URI


<a id="nestedobjatt--items--consumers--virtual_service"></a>
### Nested Schema for `items.consumers.virtual_service`

Read-Only:

- `href` (String) Virtual Service URI


<a id="nestedobjatt--items--consumers--workload"></a>
### Nested Schema for `items.consumers.workload`

Read-Only:

- `deleted` (Boolean) Whether the workload has been deleted in the PCE
- `hostname` (String) Workload hostname
- `href` (String) Workload URI
- `name` (String) Workload name



<a id="nestedobjatt--items--ingress_services"></a>
### Nested Schema for `items.ingress_services`

Read-Only:

- `href` (String) URI of service
- `port` (String) Protocol number
- `proto` (String) Port number used with protocol. Also, the starting port when specifying a range
- `to_port` (String) High end of port range inclusive if specifying a range


<a id="nestedobjatt--items--providers"></a>
### Nested Schema for `items.providers`

Read-Only:

- `actors` (String) All workloads provider filter
- `exclusion` (Boolean) Boolean to specify whether or not the actor is an exclusion - only for labels and label groups. Requires PCE v22.5+
- `ip_list` (Set of Object) IP List provider filter (see [below for nested schema](#nestedobjatt--items--providers--ip_list))
- `label` (Set of Object) Label provider filter (see [below for nested schema](#nestedobjatt--items--providers--label))
- `label_group` (Set of Object) Label Group provider filter (see [below for nested schema](#nestedobjatt--items--providers--label_group))
- `virtual_server` (Set of Object) Virtual Server provider filter (see [below for nested schema](#nestedobjatt--items--providers--virtual_server))
- `virtual_service` (Set of Object) Virtual Service provider filter (see [below for nested schema](#nestedobjatt--items--providers--virtual_service))
- `workload` (Set of Object) Workload provider filter (see [below for nested schema](#nestedobjatt--items--providers--workload))

<a id="nestedobjatt--items--providers--ip_list"></a>
### Nested Schema for `items.providers.ip_list`

Read-Only:

- `created_at` (String) Timestamp when this IP List was first created
- `created_by` (Map of String) User who created this IP List
- `deleted_at` (String) Timestamp when this IP List was last deleted
- `deleted_by` (Map of String) User who last deleted this IP List
- `description` (String) IP List description
- `external_data_reference` (String) A unique identifier within the external data source
- `external_data_set` (String) The data source from which a resource originates
- `fqdns` (List of Object) Collection of Fully Qualified Domain Names (see [below for nested schema](#nestedobjatt--items--consumers--ip_list--fqdns))
- `href` (String) IP List URI
- `ip_ranges` (List of Object) IP addresses or ranges (see [below for nested schema](#nestedobjatt--items--consumers--ip_list--ip_ranges))
- `name` (String) IP List name
- `updated_at` (String) Timestamp when this IP List was last updated
- `updated_by` (Map of String) User who last updated this IP List

<a id="nestedobjatt--items--providers--ip_list--fqdns"></a>
### Nested Schema for `items.providers.ip_list.updated_by`

Read-Only:

- `description` (String) FQDN description
- `fqdn` (String) Fully Qualified Domain Name


<a id="nestedobjatt--items--providers--ip_list--ip_ranges"></a>
### Nested Schema for `items.providers.ip_list.updated_by`

Read-Only:

- `description` (String) IP range description
- `exclusion` (Boolean) Boolean to specify whether or not the actor is an exclusion - only for labels and label groups. Requires PCE v22.5+
- `from_ip` (String) IP address or a low end of IP range. Might be specified with CIDR notation. The IP given should be in CIDR format example "0.0.0.0/0"
- `to_ip` (String) High end of an IP range



<a id="nestedobjatt--items--providers--label"></a>
### Nested Schema for `items.providers.label`

Read-Only:

- `href` (String) Label URI
- `key` (String) Label key
- `value` (String) Label value


<a id="nestedobjatt--items--providers--label_group"></a>
### Nested Schema for `items.providers.label_group`

Read-Only:

- `href` (String) Label Group URI


<a id="nestedobjatt--items--providers--virtual_server"></a>
### Nested Schema for `items.providers.virtual_server`

Read-Only:

- `href` (String) Virtual Server URI


<a id="nestedobjatt--items--providers--virtual_service"></a>
### Nested Schema for `items.providers.virtual_service`

Read-Only:

- `href` (String) Virtual Service URI
- `name` (String) Virtual Service name


<a id="nestedobjatt--items--providers--workload"></a>
### Nested Schema for `items.providers.workload`

Read-Only:

- `deleted` (Boolean) Whether the workload has been deleted in the PCE
- `hostname` (String) Workload hostname
- `href` (String) Workload URI
- `name` (String) Workload name



<a id="nestedobjatt--items--resolve_labels_as"></a>
### Nested Schema for `items.resolve_labels_as`

Read-Only:

- `consumers` (List of String) consumers of resolve_labels_as
- `providers` (List of String) providers of resolve_labels_as


