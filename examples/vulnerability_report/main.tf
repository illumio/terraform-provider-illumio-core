terraform {
  required_providers {
    illumio-core = {
      version = "0.1"
      source  = "illumio.com/labs/illumio-core"
    }
  }
}

provider "illumio-core" {
  //  pce_host              = "https://pce.my-company.com:8443"
  //  api_username          = "api_xxxxxx"
  //  api_secret            = "big-secret"
  request_timeout = 30
  org_id          = 1
}

data "illumio-core_vulnerability_report" "example" {
  href = "/orgs/1/vulnerability_reports/r1"
}

resource "illumio-core_vulnerability_report" "example" {
  name          = "example name"
  report_type   = "example-report-type"
  reference_id  = "example-id"
  authoritative = true
  exported_at   = "2021-01-01T00:00:00.000Z"
  scanned_ips   = ["11.1.1.2", "11.1.1.3"]

  detected_vulnerabilities {
    ip_address = "11.1.1.2"
    port       = "1"
    proto      = "6"
    vulnerability {
      href = "/orgs/1/vulnerabilities/example"
    }
    workload {
      href = "/orgs/1/workloads/e683b686-8afe-4675-88a1-4463395f0482"
    }
  }
}
